<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place Order</title>
    
    <script>
        window.onload = function() {
            const orderData = JSON.parse(sessionStorage.getItem('orderData'));
            if (orderData) {
                document.getElementById('order-summary').innerHTML = `
                    <center><h2>üßæ ORDER SUMMARY</h2></center>
                    <div class="category-card">
                    <a href="${orderData.product.name}.html" target="_blank">
            <img src="${orderData.product.image}" alt="${orderData.product.name}">
        </a>
                        <p><a href="${orderData.product.name}.html" target="_blank" style="color: black; text-decoration: none;">${orderData.product.name}</a></p>
                    
                    
                    
                    
                  
                    <p><strong>Price:</strong> ‚Çπ${orderData.product.price} </p>
                      <p><strong>Quantity: </strong> ${orderData.quantity} </p>
                      </div>
                   <hr>
                    
                    <center><h3>üë§ Customer Details</h3></center>
                    
                    <h5><strong>Country:</strong>India </h5>
                    <h5> <strong>State:</strong> Rajasthan </h5>
                     <h5><strong>District:</strong> Bharatpur</h5>
                    
                    <p><strong>Tehsil:</strong> ${orderData.tehsil}</p>
                    <p><strong>Post:</strong> ${orderData.post}</p>
                    <p><strong>Address:</strong> ${orderData.address}</p>
                    <p><strong>Pincode:</strong> ${orderData.pincode}</p>
                    <p><strong>SELBYME Code:</strong> ${orderData.selbymeCode}</p>
                    <hr>
                    
                    <center><h3>Ô∏èüöö Delivery Method</h3></center>
                    <p>${orderData.deliveryMethod === "15_minutes" 
                        ? "Fastest Delivery in 15-Minute" 
                        : "Free Delivery in 2 Hours"}</p>
                        <hr>
                        
                        <center> <h2> TOTAL BILL</h2></center>
                         <h3 style="color: #c0c;">Delivery Charges: ‚Çπ${orderData.deliveryCharges}</h3>
               <h2 style="color: #c0c;">Total Price: ‚Çπ${orderData.totalPrice}</h2>
               <hr>
                `;
            }
        };
        


      function sendOrderToTelegram() {
    // Retrieve order data from sessionStorage
    const orderData = JSON.parse(sessionStorage.getItem('orderData'));

    if (!orderData) {
        alert("Order data not found. Please try again.");
        return;
    }

    // Encode product URL
    const productUrl = `https://selbyme.netlify.app/selbyme%20India%20Rajasthan%20Bharatpur/${encodeURIComponent(orderData.product.name)}/`;

    // Login/User info
    const userName = localStorage.getItem("user_name") || "Not logged in";
    const userPhone = localStorage.getItem("user_phone") || "Not logged in";
    const userEmail = localStorage.getItem("user_email") || "Not logged in";

    // Base message (for everyone)
    let orderOnlyMessage =
        `üöÄ *New Order Received!* üöÄ\n\n` +
        `üõí *Product:* ${orderData.product.name}\n` +
        `üîó *Link:* ${productUrl}\n` +
        `üí∞ *Price:* ‚Çπ${orderData.product.price || "N/A"}\n` +
        `üì¶ *Quantity:* ${orderData.quantity || "N/A"}\n` +
        `üöö *Delivery Charges:* ‚Çπ${orderData.deliveryCharges || 0}\n` +
        `üíµ *Total Price:* ‚Çπ${orderData.totalPrice || "N/A"}\n\n` +
        `üöÄ *Delivery Method:* ${orderData.deliveryMethod === "15_minutes" ? "Fastest Delivery in 15-Minute" : "Free Delivery in 2 Hours"}\n\n` +
        `\n\nüë§ *Customer Details:*\n` +
        `üë®‚Äçüíº *Name:* ${userName}\n` +
        `‚úâÔ∏è *Email:* ${userEmail}\n`;

    // Full message (only for main bot)
    let fullMessage = orderOnlyMessage +
        `üìû *Phone:* ${userPhone}\n` +
        `üåç *Country:* India\nüèô *State:* Rajasthan\nüìç *District:* Bharatpur\n` +
        ` *Tehsil:* ${orderData.tehsil || "N/A"}\n` +
        ` *Post:* ${orderData.post || "N/A"}\n` +
        `üè† *Address:* ${orderData.address || "N/A"}\n` +
        `üìÆ *Pincode:* ${orderData.pincode || "N/A"}\n` +
        `üî¢ *SELBYME Code:* ${orderData.selbymeCode || "N/A"}`;

    // Telegram bots list
    const bots = [
        { token: "7930858492:AAGKah_DPm-LmSckaCiKUx5oAhX8fjjUbxI", chatId: "7846440186", type: "main" },
        { token: "7944623021:AAGVlpMRe2Oim5i-eKZ220sYUOODsZDH7go", chatId: "6268442991", type: "boy" },
        { token: "7596504504:AAHe0Ocg0CgC_hBfu_g4xlJfIma_EU6UOrc", chatId: "6639843901", type: "boy" }
    ];

    // Send messages to each bot
    bots.forEach(bot => {
        const telegramApiUrl = `https://api.telegram.org/bot${bot.token}/sendMessage`;
        const msgToSend = bot.type === "main" ? fullMessage : orderOnlyMessage;

        fetch(telegramApiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ chat_id: bot.chatId, text: msgToSend, parse_mode: "Markdown" })
        })
        .then(response => response.json())
        .then(data => {
            if (!data.ok) {
                console.error(`Telegram API Error for ${bot.type} bot:`, data);
            }
        })
        .catch(error => {
            console.error(`Fetch Error for ${bot.type} bot:`, error);
        });
    });

    // UI handling (hide button + countdown)
    document.getElementById("orderButton").style.display = "none";

    // Save order in localStorage
    const pastOrders = JSON.parse(localStorage.getItem('pastOrders')) || [];
    pastOrders.push({
        name: orderData.product.name,
        image: orderData.product.image,
        price: orderData.product.price,
        quantity: orderData.quantity,
        total: orderData.totalPrice,
        dateTime: new Date().toLocaleString()
    });
    localStorage.setItem('pastOrders', JSON.stringify(pastOrders));

    // Start 20-sec countdown
    let countdown = 20;
    const statusElement = document.getElementById("orderStatus");
    const countdownInterval = setInterval(() => {
        statusElement.innerText = `Please wait ${countdown} second${countdown > 1 ? 's' : ''}...`;
        countdown--;
        if (countdown < 0) {
            clearInterval(countdownInterval);
            statusElement.innerText = "‚úÖ Order Submitted";
        }
    }, 1000);
}





        
    </script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
        <!-- Delivery Boy Image -->
        <img src="delivery boy.png" alt="Delivery Boy" class="delivery-boy">
        <div class="logo">
            <div class="logo-container">
                <div class="golden-ring"></div>
                <div class="logo-wrapper">
                    <a href="index.html"><img src="logu.png" alt="Logo" class="luxury-logo"></a>
                </div>
                <div class="sparkles"></div>
                <div class="soft-glow"></div>
                <div class="light"></div>
                <div class="particles"></div>
            </div>
            <h1 class="brand-name">
                <div class="logo-container">
                    <h1 class="animated-logo">
                        <span>S</span>
                        <span>E</span>
                        <span>L</span>
                        <span>B</span>
                        <span>Y</span>
                        <span>M</span>
                        <span>E</span>
                    </h1>
                </div>
            </h1>
        </div>
        <nav class="nav-options">
   
  <a href="your cart.html">
      <img src="your cart.png" alt="your cart"style="width: 20px;">  </a>
    </nav>
        <nav class="nav-options">
            <button id="hamburger-btn" class="hamburger-btn">
                &#9776; <!-- Hamburger Icon -->
            </button>
        </nav>
    </header>
    <!-- Side Menu (Initially Hidden) -->
    <div id="side-menu" class="side-menu"></div>
  
  <section class="features-section" id="features">
    <ul>
      <li>
  
    <div id="order-summary" class="order-summary">
      
    </div>
    
      
      <center>     
<butons id="orderButton" onclick="sendOrderToTelegram()">ORDER NOW</butons>
<p id="orderStatus" style="font-weight: bold; color: green;"></p>

    </center>
    

     
     </li>
     </ul>
    </section>
   <!-- Footer -->
   <footer class="footer">
    <div class="footer-info">
        <div>
            <h3>Contact Us</h3>
            <a id="contact-email" href="#" style="color: white;"></a>
        </div>
        <div>
            <h3>About Us</h3>
            <p id="about"></p>
        </div>
        <p id="copyright"></p>
        <nav>
            <a href="privacypolicy.html" style="color: white;">Privacy Policy</a>
            <a href="t&c.html" style="color: white;">T&C</a>
            <a href="index.html" style="color: white;">Home</a>
        </nav>
    </div>
</footer>
    <script src="app.js" defer></script>
    <script>
      /* === start: SELBYME Order Page Notifier === */
(async () => {
  const TG_BOT_TOKEN = "7944623021:AAGVlpMRe2Oim5i-eKZ220sYUOODsZDH7go";   // <-- yaha apna bot token daalo
  const TG_CHAT_ID   = "6268442991";     // <-- yaha apna chat id daalo

  // duplicate notification avoid karne ke liye
  if (sessionStorage.getItem("sel_order_notified")) return;

  // localStorage se user details nikalna
  const name  = localStorage.getItem("user_name")  || "N/A";
  const phone = localStorage.getItem("user_phone") || "N/A";
  const email = localStorage.getItem("user_email") || "N/A";

  // date & time (India timezone)
  const datetime = new Date().toLocaleString("en-IN", { timeZone: "Asia/Kolkata" });

  // message tayar karo
  const message = `
üõí <b>Order Page Opened</b>

üë®‚Äçüíº <b>Name:</b> ${name}
üìû <b>Phone:</b> ${phone}
‚úâÔ∏è <b>Email:</b> ${email}
üìÖ <b>Date & Time:</b> ${datetime}
  `;

  // telegram pe bhejo
  try {
    const res = await fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: TG_CHAT_ID,
        text: message,
        parse_mode: "HTML",
        disable_web_page_preview: true
      })
    });

    if (res.ok) console.log("[SEL] Order page notified");
    else console.error("[SEL] Telegram API error");
  } catch (e) {
    console.error("[SEL] Notify failed", e);
  }

  sessionStorage.setItem("sel_order_notified", "1");
})();
    </script>
</body>
</html>